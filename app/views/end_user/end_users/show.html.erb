<div class="container my-5">
  <div class="row">
    <div class="col-md-8 col-lg-8">
      <% if @end_user.id == current_end_user.id %>
        <span><%= link_to "edit", edit_end_user_path, class: "btn btn-success rounded-pill px4 ml-3" %></span>
      <% end %>
    </div>
  </div>

  <div class="row">
    <div class="col-md-8 col-lg-8">
      <div class="mt-3">
        <%= attachment_image_tag @end_user, :profile_pic, :fill, 60, 60, class:"rounded-circle" %>
        <%= @end_user.nickname %>
      </div>
      <table class="table table-bordered table-condensed mt-3">
        <tr>
          <td>self_introduction</td>
          <td><%= @end_user.self_introduction %></td>
        </tr>
        <tr>
          <td>
            <p>id:<%= @end_user.id %></p>
            <p>フォロー数: <%= @end_user.follower.count %></p>
            <p>フォロワー数: <%= @end_user.followed.count %></p>
          </td>
        </tr>
        <tr>
          <td>
            <% unless @end_user == current_end_user %>
              <% if current_end_user.following?(@end_user) %>
                <%= link_to "フォロー外す", unfollow_path(@end_user), method: :post %>
              <% else %>
                <%= link_to "フォローする", follow_path(@end_user), method: :post %>
              <% end %>
            <% end %>
          </td>
        </tr>
      </table>
      <table class="table table-bordered table-condensed mt-3">
        <thead>
          <tr>
            <th>フォロー一覧</th>
          </tr>
        </thead>
        <% @end_user.following_end_user.where.not(id: current_end_user.id).each do |end_user| %>
        <tr>
          <td>
            <p>id: <%= end_user.id %></p>
            <p>
              <%= link_to end_user_path(end_user) do %>
                <%= end_user.nickname %>
              <% end %>
            </p>
            <% if current_end_user.following?(end_user) %>
              <%= link_to "フォロー外す", unfollow_path(end_user.id), method: :post %>
            <% else %>
              <%= link_to 'フォローする', follow_path(end_user.id), method: :post %>
            <% end %>
          </td>
        </tr>
        <% end %>
      </table>
      
      <table class="table table-bordered table-condensed mt-3">
        <thead>
          <tr>
            <th>フォロワー一覧</th>
          </tr>
        </thead>
        <% @end_user.follower_end_user.where.not(id: current_end_user.id).each do |end_user| %>
        <tr>
          <td>
            <p>id: <%= end_user.id %></p>
            <p>
              <%= link_to end_user_path(end_user) do %>
                <%= end_user.nickname %>
              <% end %>
            </p>
            <% if current_end_user.following?(end_user) %>
              <%= link_to "フォロー外す", unfollow_path(end_user.id), method: :post %>
            <% else %>
              <%= link_to 'フォローする', follow_path(end_user.id), method: :post %>
            <% end %>
          </td>
        </tr>
        <% end %>
      </table>

    </div>
  </div>
</div>